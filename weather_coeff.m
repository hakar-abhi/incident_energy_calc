% Fourier Series Curve Fit for Water Vapor Content for Nepal

% Water vapor content Estimate Model:

% we use model W = We + error where We is estimated of water vapor in
% atmosphere

%   We = G1 + G2.sint + G3.sin2t + G4.sin3t + G5.cost + G6.cos2t + G7.cos3t
%   Gi = gi1 + gi2.x + gi3.x^2


%   t = 2*pi*(N-80)/365
%   We = water vapor content in estimated from another Fourier Curve fit
%       model


%   The program gives the coeffecient gi1,..... gi3 for Water Vapor
%   Content.


clc
clear

%Number of days
N = [15;46;74;105;135;166;196;227;258;288;319;349;
    15;46;74;105;135;166;196;227;258;288;319;349;
    15;46;74;105;135;166;196;227;258;288;319;349;
    15;46;74;105;135;166;196;227;258;288;319;349;
    15;46;74;105;135;166;196;227;258;288;319;349;
    15;46;74;105;135;166;196;227;258;288;319;349;
    15;46;74;105;135;166;196;227;258;288;319;349;
    15;46;74;105;135;166;196;227;258;288;319;349;
    15;46;74;105;135;166;196;227;258;288;319;349;
    15;46;74;105;135;166;196;227;258;288;319;349;
    15;46;74;105;135;166;196;227;258;288;319;349;
    15;46;74;105;135;166;196;227;258;288;319;349];

% Latitude in Degrees

Q = [23.07;23.07;23.07;23.07;23.07;23.07;23.07;23.07;23.07;23.07;23.07;23.07;
    21.75;21.75;21.75;21.75;21.75;21.75;21.75;21.75;21.75;21.75;21.75;21.75;
    19.12;19.12;19.12;19.12;19.12;19.12;19.12;19.12;19.12;19.12;19.12;19.12;
    22.65;22.65;22.65;22.65;22.65;22.65;22.65;22.65;22.65;22.65;22.65;22.65;
    26.30;26.30;26.30;26.30;26.30;26.30;26.30;26.30;26.30;26.30;26.30;26.30;
    10.23;10.23;10.23;10.23;10.23;10.23;10.23;10.23;10.23;10.23;10.23;10.23;
    13.00;13.00;13.00;13.00;13.00;13.00;13.00;13.00;13.00;13.00;13.00;13.00;
    21.15;21.15;21.15;21.15;21.15;21.15;21.15;21.15;21.15;21.15;21.15;21.15;
    28.58;28.58;28.58;28.58;28.58;28.58;28.58;28.58;28.58;28.58;28.58;28.58;
    18.53;18.53;18.53;18.53;18.53;18.53;18.53;18.53;18.53;18.53;18.53;18.53;
    08.48;08.48;08.48;08.48;08.48;08.48;08.48;08.48;08.48;08.48;08.48;08.48;
    17.72;17.72;17.72;17.72;17.72;17.72;17.72;17.72;17.72;17.72;17.72;17.72];


% water vapor content


w = [1.67;1.82;2.16;2.73;3.33;4.66;5.37;5.32;4.40;3.27;2.00;1.91;
    1.84;1.85;2.30;2.88;3.42;4.81;5.32;5.16;4.59;3.31;2.29;2.03;
    2.70;2.55;2.90;3.30;3.95;5.17;5.36;5.05;4.78;4.01;2.94;2.93;
    2.10;2.22;2.63;3.49;4.30;5.62;6.28;6.17;5.69;4.55;2.86;2.06;
    1.59;1.60;1.83;2.29;2.86;4.22;5.23;5.25;3.91;2.53;1.71;1.73;
    0.74;0.77;0.77;1.12;1.58;1.86;1.88;1.77;1.82;1.63;1.04;0.91;
    2.73;2.66;2.51;3.25;4.36;5.07;5.09;4.94;4.82;4.64;3.45;3.12;
    1.75;2.09;2.08;2.58;2.99;4.66;5.32;5.41;4.59;3.53;1.99;1.89;
    1.40;1.38;1.66;1.93;2.55;4.01;5.56;5.74;4.19;2.67;1.50;1.42;
    1.77;1.75;2.06;2.45;2.87;3.94;4.26;4.12;3.86;3.15;2.29;2.09;
    3.02;3.16;3.49;4.30;4.47;4.47;4.46;4.29;4.39;4.37;4.02;3.67;
    2.73;3.21;3.08;3.98;4.59;5.50;5.55;5.48;5.39;4.91;3.18;2.67];



x = (Q-35);
t = ((2*pi)/365).*(N-80);

n = length(x);
c(1:n,1)=1;
c(1:n,2)=x;
c(1:n,3)=x.*x;



c(1:n,4)=sin(t);
c(1:n,5)=x.*sin(t);
c(1:n,6)=x.*x.*sin(t);

c(1:n,7)=sin(2*t);
c(1:n,8)=x.*sin(2*t);
c(1:n,9)=x.*x.*sin(2*t);

c(1:n,10)=sin(3*t);
c(1:n,11)=x.*sin(3*t);
c(1:n,12)=x.*x.*sin(3*t);

c(1:n,13)=cos(t);
c(1:n,14)=x.*cos(t);
c(1:n,15)=x.*x.*cos(t);

c(1:n,16)=cos(2*t);
c(1:n,17)=x.*cos(2*t);
c(1:n,18)=x.*x.*cos(2*t);

c(1:n,19)=cos(3*t);
c(1:n,20)=x.*cos(3*t);
c(1:n,21)=x.*x.*cos(3*t);

[row, col] = size(c);
for i = 1:col
    for j = 1:col
        A(i,j) = sum(c(1:n,j).*c(1:n,i));
        b(i) = sum(w.*c(1:n,i));
    end
end

coeff = A\b';
k = 1;
for i = 1:7
    for j =1:3
        G(i,j) = coeff(k);
        k = k+1;
    end
end
G